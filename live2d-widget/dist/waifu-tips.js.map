{"version":3,"file":"waifu-tips.js","sources":["../build/utils.js","../build/message.js","../build/logger.js","../build/model.js","../build/tools.js","../build/icons.js","../build/widget.js","../build/drag.js","../build/waifu-tips.js"],"sourcesContent":["function randomSelection(obj) {\n    return Array.isArray(obj) ? obj[Math.floor(Math.random() * obj.length)] : obj;\n}\nfunction loadExternalResource(url, type) {\n    return new Promise((resolve, reject) => {\n        let tag;\n        if (type === 'css') {\n            tag = document.createElement('link');\n            tag.rel = 'stylesheet';\n            tag.href = url;\n        }\n        else if (type === 'js') {\n            tag = document.createElement('script');\n            tag.src = url;\n        }\n        if (tag) {\n            tag.onload = () => resolve(url);\n            tag.onerror = () => reject(url);\n            document.head.appendChild(tag);\n        }\n    });\n}\nexport { randomSelection, loadExternalResource };\n","import { randomSelection } from './utils.js';\nlet messageTimer = null;\nfunction showMessage(text, timeout, priority) {\n    if (!text ||\n        (sessionStorage.getItem('waifu-text') &&\n            Number(sessionStorage.getItem('waifu-text')) > priority))\n        return;\n    if (messageTimer) {\n        clearTimeout(messageTimer);\n        messageTimer = null;\n    }\n    text = randomSelection(text);\n    sessionStorage.setItem('waifu-text', String(priority));\n    const tips = document.getElementById('waifu-tips');\n    tips.innerHTML = text;\n    tips.classList.add('waifu-tips-active');\n    messageTimer = setTimeout(() => {\n        sessionStorage.removeItem('waifu-text');\n        tips.classList.remove('waifu-tips-active');\n    }, timeout);\n}\nfunction welcomeMessage(time) {\n    if (location.pathname === '/') {\n        for (const { hour, text } of time) {\n            const now = new Date(), after = hour.split('-')[0], before = hour.split('-')[1] || after;\n            if (Number(after) <= now.getHours() &&\n                now.getHours() <= Number(before)) {\n                return text;\n            }\n        }\n    }\n    const text = `欢迎阅读<span>「${document.title.split(' - ')[0]}」</span>`;\n    let from;\n    if (document.referrer !== '') {\n        const referrer = new URL(document.referrer), domain = referrer.hostname.split('.')[1];\n        const domains = {\n            baidu: '百度',\n            so: '360搜索',\n            google: '谷歌搜索',\n        };\n        if (location.hostname === referrer.hostname)\n            return text;\n        if (domain in domains)\n            from = domains[domain];\n        else\n            from = referrer.hostname;\n        return `Hello！来自 <span>${from}</span> 的朋友<br>${text}`;\n    }\n    return text;\n}\nexport { showMessage, welcomeMessage };\n","class Logger {\n    constructor(level = 'info') {\n        this.level = level;\n    }\n    setLevel(level) {\n        if (!level)\n            return;\n        this.level = level;\n    }\n    shouldLog(level) {\n        return Logger.levelOrder[level] <= Logger.levelOrder[this.level];\n    }\n    error(message, ...args) {\n        if (this.shouldLog('error')) {\n            console.error('[Live2D Widget][ERROR]', message, ...args);\n        }\n    }\n    warn(message, ...args) {\n        if (this.shouldLog('warn')) {\n            console.warn('[Live2D Widget][WARN ]', message, ...args);\n        }\n    }\n    info(message, ...args) {\n        if (this.shouldLog('info')) {\n            console.log('[Live2D Widget][INFO ]', message, ...args);\n        }\n    }\n    trace(message, ...args) {\n        if (this.shouldLog('trace')) {\n            console.log('[Live2D Widget][TRACE]', message, ...args);\n        }\n    }\n}\nLogger.levelOrder = {\n    error: 0,\n    warn: 1,\n    info: 2,\n    trace: 3,\n};\nconst logger = new Logger();\nexport default logger;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { showMessage } from './message.js';\nimport { randomSelection, loadExternalResource } from './utils.js';\nimport logger from './logger.js';\nclass ModelManager {\n    constructor(config, models = []) {\n        var _b;\n        this.modelList = null;\n        let { apiPath, cdnPath } = config;\n        const { cubism2Path, cubism5Path } = config;\n        let useCDN = false;\n        if (typeof cdnPath === 'string') {\n            if (!cdnPath.endsWith('/'))\n                cdnPath += '/';\n            useCDN = true;\n        }\n        else if (typeof apiPath === 'string') {\n            if (!apiPath.endsWith('/'))\n                apiPath += '/';\n            cdnPath = apiPath;\n            useCDN = true;\n            logger.warn('apiPath option is deprecated. Please use cdnPath instead.');\n        }\n        else if (!models.length) {\n            throw 'Invalid initWidget argument!';\n        }\n        let modelId = parseInt(localStorage.getItem('modelId'), 10);\n        let modelTexturesId = parseInt(localStorage.getItem('modelTexturesId'), 10);\n        if (isNaN(modelId) || isNaN(modelTexturesId)) {\n            modelTexturesId = 0;\n        }\n        if (isNaN(modelId)) {\n            modelId = (_b = config.modelId) !== null && _b !== void 0 ? _b : 0;\n        }\n        this.useCDN = useCDN;\n        this.cdnPath = cdnPath || '';\n        this.cubism2Path = cubism2Path || '';\n        this.cubism5Path = cubism5Path || '';\n        this._modelId = modelId;\n        this._modelTexturesId = modelTexturesId;\n        this.currentModelVersion = 0;\n        this.loading = false;\n        this.modelJSONCache = {};\n        this.models = models;\n    }\n    set modelId(modelId) {\n        this._modelId = modelId;\n        localStorage.setItem('modelId', modelId.toString());\n    }\n    get modelId() {\n        return this._modelId;\n    }\n    set modelTexturesId(modelTexturesId) {\n        this._modelTexturesId = modelTexturesId;\n        localStorage.setItem('modelTexturesId', modelTexturesId.toString());\n    }\n    get modelTexturesId() {\n        return this._modelTexturesId;\n    }\n    resetCanvas() {\n        document.getElementById('waifu-canvas').innerHTML = '<canvas id=\"live2d\" width=\"800\" height=\"800\"></canvas>';\n    }\n    fetchWithCache(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let result;\n            if (url in this.modelJSONCache) {\n                result = this.modelJSONCache[url];\n            }\n            else {\n                const response = yield fetch(url);\n                result = yield response.json();\n                this.modelJSONCache[url] = result;\n            }\n            return result;\n        });\n    }\n    checkModelVersion(modelSetting) {\n        if (modelSetting.Version === 3 || modelSetting.FileReferences) {\n            return 3;\n        }\n        return 2;\n    }\n    loadLive2D(modelSettingPath, modelSetting) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.loading) {\n                logger.warn('Still loading. Abort.');\n                return;\n            }\n            this.loading = true;\n            try {\n                const version = this.checkModelVersion(modelSetting);\n                if (version === 2) {\n                    if (!this.cubism2model) {\n                        if (!this.cubism2Path) {\n                            logger.error('No cubism2Path set, cannot load Cubism 2 Core.');\n                            return;\n                        }\n                        yield loadExternalResource(this.cubism2Path, 'js');\n                        const { default: Cubism2Model } = yield import('./cubism2/index.js');\n                        this.cubism2model = new Cubism2Model();\n                    }\n                    if (this.currentModelVersion === 3) {\n                        this.cubism5model.release();\n                        this.resetCanvas();\n                    }\n                    if (this.currentModelVersion === 3 || !this.cubism2model.gl) {\n                        yield this.cubism2model.init('live2d', modelSettingPath, modelSetting);\n                    }\n                    else {\n                        yield this.cubism2model.changeModelWithJSON(modelSettingPath, modelSetting);\n                    }\n                }\n                else {\n                    if (!this.cubism5Path) {\n                        logger.error('No cubism5Path set, cannot load Cubism 5 Core.');\n                        return;\n                    }\n                    yield loadExternalResource(this.cubism5Path, 'js');\n                    const { AppDelegate: Cubism5Model } = yield import('./cubism5/index.js');\n                    this.cubism5model = new Cubism5Model();\n                    if (this.currentModelVersion === 2) {\n                        this.cubism2model.destroy();\n                        this.resetCanvas();\n                    }\n                    if (this.currentModelVersion === 2 || !this.cubism5model.subdelegates.at(0)) {\n                        this.cubism5model.initialize();\n                        this.cubism5model.changeModel(modelSettingPath);\n                        this.cubism5model.run();\n                    }\n                    else {\n                        this.cubism5model.changeModel(modelSettingPath);\n                    }\n                }\n                logger.info(`Model ${modelSettingPath} (Cubism version ${version}) loaded`);\n                this.currentModelVersion = version;\n            }\n            catch (err) {\n                console.error('loadLive2D failed', err);\n            }\n            this.loading = false;\n        });\n    }\n    loadModelList() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const response = yield fetch(`${this.cdnPath}model_list.json`);\n            const modelList = yield response.json();\n            return modelList;\n        });\n    }\n    loadTextureCache(modelName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const textureCache = yield this.fetchWithCache(`${this.cdnPath}model/${modelName}/textures.cache`);\n            return textureCache;\n        });\n    }\n    loadModel(message) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.useCDN) {\n                if (!this.modelList) {\n                    this.modelList = yield this.loadModelList();\n                }\n                if (this.modelId >= this.modelList.models.length) {\n                    this.modelId = 0;\n                }\n                const modelName = randomSelection(this.modelList.models[this.modelId]);\n                const modelSettingPath = `${this.cdnPath}model/${modelName}/index.json`;\n                const modelSetting = yield this.fetchWithCache(modelSettingPath);\n                const version = this.checkModelVersion(modelSetting);\n                if (version === 2) {\n                    const textureCache = yield this.loadTextureCache(modelName);\n                    if (this.modelTexturesId >= textureCache.length) {\n                        this.modelTexturesId = 0;\n                    }\n                    let textures = textureCache[this.modelTexturesId];\n                    if (typeof textures === 'string')\n                        textures = [textures];\n                    modelSetting.textures = textures;\n                }\n                yield this.loadLive2D(modelSettingPath, modelSetting);\n            }\n            else {\n                if (this.modelId >= this.models.length) {\n                    this.modelId = 0;\n                }\n                if (this.modelTexturesId >= this.models[this.modelId].paths.length) {\n                    this.modelTexturesId = 0;\n                }\n                const modelSettingPath = this.models[this.modelId].paths[this.modelTexturesId];\n                const modelSetting = yield this.fetchWithCache(modelSettingPath);\n                yield this.loadLive2D(modelSettingPath, modelSetting);\n            }\n            showMessage(message, 4000, 10);\n        });\n    }\n    loadRandTexture() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const { modelId } = this;\n            if (this.useCDN) {\n                if (!this.modelList) {\n                    this.modelList = yield this.loadModelList();\n                }\n                const modelName = randomSelection(this.modelList.models[modelId]);\n                const modelSettingPath = `${this.cdnPath}model/${modelName}/index.json`;\n                const modelSetting = yield this.fetchWithCache(modelSettingPath);\n                const version = this.checkModelVersion(modelSetting);\n                if (version === 2) {\n                    const textureCache = yield this.loadTextureCache(modelName);\n                    this.modelTexturesId = Math.floor(Math.random() * textureCache.length);\n                    let textures = textureCache[this.modelTexturesId];\n                    if (typeof textures === 'string')\n                        textures = [textures];\n                    modelSetting.textures = textures;\n                }\n                yield this.loadLive2D(modelSettingPath, modelSetting);\n                showMessage('我的新衣服好看嘛？', 4000, 10);\n            }\n            else {\n                this.modelTexturesId = Math.floor(Math.random() * this.models[modelId].paths.length);\n                const modelSettingPath = this.models[modelId].paths[this.modelTexturesId];\n                const modelSetting = yield this.fetchWithCache(modelSettingPath);\n                yield this.loadLive2D(modelSettingPath, modelSetting);\n                showMessage('我的新衣服好看嘛？', 4000, 10);\n            }\n        });\n    }\n    loadNextModel() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.modelTexturesId = 0;\n            if (this.useCDN) {\n                if (!this.modelList) {\n                    this.modelList = yield this.loadModelList();\n                }\n                this.modelId = (this.modelId + 1) % this.modelList.models.length;\n                yield this.loadModel(this.modelList.messages[this.modelId]);\n            }\n            else {\n                this.modelId = (this.modelId + 1) % this.models.length;\n                yield this.loadModel(this.models[this.modelId].message);\n            }\n        });\n    }\n}\nexport { ModelManager };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { fa_comment, fa_paper_plane, fa_user_circle, fa_street_view, fa_camera_retro, fa_info_circle, fa_xmark } from './icons.js';\nimport { showMessage } from './message.js';\nfunction showHitokoto() {\n    return __awaiter(this, void 0, void 0, function* () {\n        const response = yield fetch('https://v1.hitokoto.cn');\n        const result = yield response.json();\n        const text = `这句一言来自 <span>「${result.from}」</span>，是 <span>${result.creator}</span> 在 hitokoto.cn 投稿的。`;\n        showMessage(result.hitokoto, 6000, 9);\n        setTimeout(() => {\n            showMessage(text, 4000, 9);\n        }, 6000);\n    });\n}\nconst tools = {\n    hitokoto: {\n        icon: fa_comment,\n        callback: showHitokoto,\n    },\n    asteroids: {\n        icon: fa_paper_plane,\n        callback: () => {\n            if (window.Asteroids) {\n                if (!window.ASTEROIDSPLAYERS)\n                    window.ASTEROIDSPLAYERS = [];\n                window.ASTEROIDSPLAYERS.push(new window.Asteroids());\n            }\n            else {\n                const script = document.createElement('script');\n                script.src =\n                    'https://fastly.jsdelivr.net/gh/stevenjoezhang/asteroids/asteroids.js';\n                document.head.appendChild(script);\n            }\n        },\n    },\n    'switch-model': {\n        icon: fa_user_circle,\n        callback: () => { },\n    },\n    'switch-texture': {\n        icon: fa_street_view,\n        callback: () => { },\n    },\n    photo: {\n        icon: fa_camera_retro,\n        callback: () => {\n            showMessage('照好了嘛，是不是很可爱呢？', 6000, 9);\n            const canvas = document.getElementById('live2d');\n            if (!canvas)\n                return;\n            const imageUrl = canvas.toDataURL();\n            const link = document.createElement('a');\n            link.style.display = 'none';\n            link.href = imageUrl;\n            link.download = 'live2d-photo.png';\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        },\n    },\n    info: {\n        icon: fa_info_circle,\n        callback: () => {\n            open('https://github.com/stevenjoezhang/live2d-widget');\n        },\n    },\n    quit: {\n        icon: fa_xmark,\n        callback: () => {\n            localStorage.setItem('waifu-display', Date.now().toString());\n            showMessage('愿你有一天能与重要的人重逢。', 2000, 11);\n            const waifu = document.getElementById('waifu');\n            if (!waifu)\n                return;\n            waifu.style.bottom = '-500px';\n            setTimeout(() => {\n                waifu.style.display = 'none';\n                const waifuToggle = document.getElementById('waifu-toggle');\n                if (!waifuToggle)\n                    return;\n                waifuToggle.classList.add('waifu-toggle-active');\n            }, 3000);\n        },\n    },\n};\nexport default tools;\n","const fa_comment = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M512 240c0 114.9-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6C73.6 471.1 44.7 480 16 480c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c0 0 0 0 0 0s0 0 0 0s0 0 0 0c0 0 0 0 0 0l.3-.3c.3-.3 .7-.7 1.3-1.4c1.1-1.2 2.8-3.1 4.9-5.7c4.1-5 9.6-12.4 15.2-21.6c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208z\"/></svg>';\nconst fa_paper_plane = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z\"/></svg>';\nconst fa_user_circle = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M399 384.2C376.9 345.8 335.4 320 288 320l-64 0c-47.4 0-88.9 25.8-111 64.2c35.2 39.2 86.2 63.8 143 63.8s107.8-24.7 143-63.8zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256 16a72 72 0 1 0 0-144 72 72 0 1 0 0 144z\"/></svg>';\nconst fa_street_view = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M320 64A64 64 0 1 0 192 64a64 64 0 1 0 128 0zm-96 96c-35.3 0-64 28.7-64 64l0 48c0 17.7 14.3 32 32 32l1.8 0 11.1 99.5c1.8 16.2 15.5 28.5 31.8 28.5l38.7 0c16.3 0 30-12.3 31.8-28.5L318.2 304l1.8 0c17.7 0 32-14.3 32-32l0-48c0-35.3-28.7-64-64-64l-64 0zM132.3 394.2c13-2.4 21.7-14.9 19.3-27.9s-14.9-21.7-27.9-19.3c-32.4 5.9-60.9 14.2-82 24.8c-10.5 5.3-20.3 11.7-27.8 19.6C6.4 399.5 0 410.5 0 424c0 21.4 15.5 36.1 29.1 45c14.7 9.6 34.3 17.3 56.4 23.4C130.2 504.7 190.4 512 256 512s125.8-7.3 170.4-19.6c22.1-6.1 41.8-13.8 56.4-23.4c13.7-8.9 29.1-23.6 29.1-45c0-13.5-6.4-24.5-14-32.6c-7.5-7.9-17.3-14.3-27.8-19.6c-21-10.6-49.5-18.9-82-24.8c-13-2.4-25.5 6.3-27.9 19.3s6.3 25.5 19.3 27.9c30.2 5.5 53.7 12.8 69 20.5c3.2 1.6 5.8 3.1 7.9 4.5c3.6 2.4 3.6 7.2 0 9.6c-8.8 5.7-23.1 11.8-43 17.3C374.3 457 318.5 464 256 464s-118.3-7-157.7-17.9c-19.9-5.5-34.2-11.6-43-17.3c-3.6-2.4-3.6-7.2 0-9.6c2.1-1.4 4.8-2.9 7.9-4.5c15.3-7.7 38.8-14.9 69-20.5z\"/></svg>';\nconst fa_camera_retro = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M220.6 121.2L271.1 96 448 96l0 96-114.8 0c-21.9-15.1-48.5-24-77.2-24s-55.2 8.9-77.2 24L64 192l0-64 128 0c9.9 0 19.7-2.3 28.6-6.8zM0 128L0 416c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L271.1 32c-9.9 0-19.7 2.3-28.6 6.8L192 64l-32 0 0-16c0-8.8-7.2-16-16-16L80 32c-8.8 0-16 7.2-16 16l0 16C28.7 64 0 92.7 0 128zM168 304a88 88 0 1 1 176 0 88 88 0 1 1 -176 0z\"/></svg>';\nconst fa_info_circle = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336l24 0 0-64-24 0c-13.3 0-24-10.7-24-24s10.7-24 24-24l48 0c13.3 0 24 10.7 24 24l0 88 8 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-80 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z\"/></svg>';\nconst fa_xmark = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d=\"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z\"/></svg>';\nexport { fa_comment, fa_paper_plane, fa_user_circle, fa_street_view, fa_camera_retro, fa_info_circle, fa_xmark };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { ModelManager } from './model.js';\nimport { showMessage, welcomeMessage } from './message.js';\nimport { randomSelection } from './utils.js';\nimport tools from './tools.js';\nimport logger from './logger.js';\nimport registerDrag from './drag.js';\nfunction registerTools(model, config) {\n    tools['switch-model'].callback = () => model.loadNextModel();\n    tools['switch-texture'].callback = () => model.loadRandTexture();\n    if (!Array.isArray(config.tools)) {\n        config.tools = Object.keys(tools);\n    }\n    for (const toolName of config.tools) {\n        if (tools[toolName]) {\n            const { icon, callback } = tools[toolName];\n            document\n                .getElementById('waifu-tool')\n                .insertAdjacentHTML('beforeend', `<span id=\"waifu-tool-${toolName}\">${icon}</span>`);\n            document\n                .getElementById(`waifu-tool-${toolName}`)\n                .addEventListener('click', callback);\n        }\n    }\n}\nfunction registerEventListener(tips) {\n    let userAction = false;\n    let userActionTimer;\n    const messageArray = tips.message.default;\n    let lastHoverElement;\n    window.addEventListener('mousemove', () => (userAction = true));\n    window.addEventListener('keydown', () => (userAction = true));\n    setInterval(() => {\n        if (userAction) {\n            userAction = false;\n            clearInterval(userActionTimer);\n            userActionTimer = null;\n        }\n        else if (!userActionTimer) {\n            userActionTimer = setInterval(() => {\n                showMessage(randomSelection(messageArray), 6000, 9);\n            }, 20000);\n        }\n    }, 1000);\n    showMessage(welcomeMessage(tips.time), 7000, 11);\n    window.addEventListener('mouseover', (event) => {\n        var _b;\n        for (let { selector, text } of tips.mouseover) {\n            if (!((_b = event.target) === null || _b === void 0 ? void 0 : _b.closest(selector)))\n                continue;\n            if (lastHoverElement === selector)\n                return;\n            lastHoverElement = selector;\n            text = randomSelection(text);\n            text = text.replace('{text}', event.target.innerText);\n            showMessage(text, 4000, 8);\n            return;\n        }\n    });\n    window.addEventListener('click', (event) => {\n        var _b;\n        for (let { selector, text } of tips.click) {\n            if (!((_b = event.target) === null || _b === void 0 ? void 0 : _b.closest(selector)))\n                continue;\n            text = randomSelection(text);\n            text = text.replace('{text}', event.target.innerText);\n            showMessage(text, 4000, 8);\n            return;\n        }\n    });\n    tips.seasons.forEach(({ date, text }) => {\n        const now = new Date(), after = date.split('-')[0], before = date.split('-')[1] || after;\n        if (Number(after.split('/')[0]) <= now.getMonth() + 1 &&\n            now.getMonth() + 1 <= Number(before.split('/')[0]) &&\n            Number(after.split('/')[1]) <= now.getDate() &&\n            now.getDate() <= Number(before.split('/')[1])) {\n            text = randomSelection(text);\n            text = text.replace('{year}', String(now.getFullYear()));\n            messageArray.push(text);\n        }\n    });\n    const devtools = () => { };\n    console.log('%c', devtools);\n    devtools.toString = () => {\n        showMessage(tips.message.console, 6000, 9);\n    };\n    window.addEventListener('copy', () => {\n        showMessage(tips.message.copy, 6000, 9);\n    });\n    window.addEventListener('visibilitychange', () => {\n        if (!document.hidden)\n            showMessage(tips.message.visibilitychange, 6000, 9);\n    });\n}\nfunction loadWidget(config) {\n    return __awaiter(this, void 0, void 0, function* () {\n        localStorage.removeItem('waifu-display');\n        sessionStorage.removeItem('waifu-text');\n        document.body.insertAdjacentHTML('beforeend', `<div id=\"waifu\">\n       <div id=\"waifu-tips\"></div>\n       <div id=\"waifu-canvas\">\n         <canvas id=\"live2d\" width=\"800\" height=\"800\"></canvas>\n       </div>\n       <div id=\"waifu-tool\"></div>\n     </div>`);\n        let models = [];\n        if (config.waifuPath) {\n            const response = yield fetch(config.waifuPath);\n            const result = yield response.json();\n            models = result.models;\n            registerEventListener(result);\n        }\n        const model = new ModelManager(config, models);\n        yield model.loadModel('');\n        registerTools(model, config);\n        if (config.drag)\n            registerDrag();\n        document.getElementById('waifu').style.bottom = '0';\n    });\n}\nfunction initWidget(config) {\n    if (typeof config === 'string') {\n        logger.error('Your config for Live2D initWidget is outdated. Please refer to https://github.com/stevenjoezhang/live2d-widget/blob/master/dist/autoload.js');\n        return;\n    }\n    logger.setLevel(config.logLevel);\n    document.body.insertAdjacentHTML('beforeend', `<div id=\"waifu-toggle\">\n       <span>看板娘</span>\n     </div>`);\n    const toggle = document.getElementById('waifu-toggle');\n    toggle === null || toggle === void 0 ? void 0 : toggle.addEventListener('click', () => {\n        toggle.classList.remove('waifu-toggle-active');\n        if (toggle === null || toggle === void 0 ? void 0 : toggle.getAttribute('first-time')) {\n            loadWidget(config);\n            toggle === null || toggle === void 0 ? void 0 : toggle.removeAttribute('first-time');\n        }\n        else {\n            localStorage.removeItem('waifu-display');\n            document.getElementById('waifu').style.display = '';\n            setTimeout(() => {\n                document.getElementById('waifu').style.bottom = '0';\n            }, 0);\n        }\n    });\n    if (localStorage.getItem('waifu-display') &&\n        Date.now() - Number(localStorage.getItem('waifu-display')) <= 86400000) {\n        toggle === null || toggle === void 0 ? void 0 : toggle.setAttribute('first-time', 'true');\n        setTimeout(() => {\n            toggle === null || toggle === void 0 ? void 0 : toggle.classList.add('waifu-toggle-active');\n        }, 0);\n    }\n    else {\n        loadWidget(config);\n    }\n}\nexport { initWidget };\n","function registerDrag() {\n    const element = document.getElementById('waifu');\n    if (!element)\n        return;\n    let winWidth = window.innerWidth, winHeight = window.innerHeight;\n    const imgWidth = element.offsetWidth, imgHeight = element.offsetHeight;\n    element.addEventListener('mousedown', event => {\n        if (event.button === 2) {\n            return;\n        }\n        const canvas = document.getElementById('live2d');\n        if (event.target !== canvas)\n            return;\n        event.preventDefault();\n        const _offsetX = event.offsetX, _offsetY = event.offsetY;\n        document.onmousemove = event => {\n            const _x = event.clientX, _y = event.clientY;\n            let _left = _x - _offsetX, _top = _y - _offsetY;\n            if (_top < 0) {\n                _top = 0;\n            }\n            else if (_top >= winHeight - imgHeight) {\n                _top = winHeight - imgHeight;\n            }\n            if (_left < 0) {\n                _left = 0;\n            }\n            else if (_left >= winWidth - imgWidth) {\n                _left = winWidth - imgWidth;\n            }\n            element.style.top = _top + 'px';\n            element.style.left = _left + 'px';\n        };\n        document.onmouseup = () => {\n            document.onmousemove = null;\n        };\n    });\n    window.onresize = () => {\n        winWidth = window.innerWidth;\n        winHeight = window.innerHeight;\n    };\n}\nexport default registerDrag;\n","import { initWidget } from './widget.js';\nwindow.initWidget = initWidget;\n"],"names":["randomSelection","obj","Array","isArray","Math","floor","random","length","loadExternalResource","url","type","Promise","resolve","reject","tag","document","createElement","src","onload","onerror","head","appendChild","messageTimer","showMessage","text","timeout","priority","sessionStorage","getItem","Number","clearTimeout","setItem","String","tips","getElementById","innerHTML","classList","add","setTimeout","removeItem","remove","Logger","constructor","level","this","setLevel","shouldLog","levelOrder","error","message","args","console","warn","info","log","trace","logger","__awaiter","thisArg","_arguments","P","generator","fulfilled","value","step","next","e","rejected","result","done","then","apply","ModelManager","config","models","_b","modelList","apiPath","cdnPath","cubism2Path","cubism5Path","useCDN","endsWith","modelId","parseInt","localStorage","modelTexturesId","isNaN","_modelId","_modelTexturesId","currentModelVersion","loading","modelJSONCache","toString","resetCanvas","fetchWithCache","response","fetch","json","checkModelVersion","modelSetting","Version","FileReferences","loadLive2D","modelSettingPath","version","cubism2model","default","Cubism2Model","import","cubism5model","release","gl","changeModelWithJSON","init","AppDelegate","Cubism5Model","destroy","subdelegates","at","changeModel","initialize","run","err","loadModelList","loadTextureCache","modelName","loadModel","textureCache","textures","paths","loadRandTexture","loadNextModel","messages","tools","hitokoto","icon","callback","from","creator","asteroids","window","Asteroids","ASTEROIDSPLAYERS","push","script","photo","canvas","imageUrl","toDataURL","link","style","display","href","download","body","click","removeChild","open","quit","Date","now","waifu","bottom","waifuToggle","registerEventListener","userActionTimer","userAction","messageArray","lastHoverElement","addEventListener","setInterval","clearInterval","time","location","pathname","hour","after","split","before","getHours","title","referrer","URL","domain","hostname","domains","baidu","so","google","welcomeMessage","event","selector","mouseover","target","closest","replace","innerText","seasons","forEach","date","getMonth","getDate","getFullYear","devtools","copy","hidden","visibilitychange","loadWidget","insertAdjacentHTML","waifuPath","model","Object","keys","toolName","registerTools","drag","element","winWidth","innerWidth","winHeight","innerHeight","imgWidth","offsetWidth","imgHeight","offsetHeight","button","preventDefault","_offsetX","offsetX","_offsetY","offsetY","onmousemove","_x","clientX","_y","clientY","_left","_top","top","left","onmouseup","onresize","registerDrag","initWidget","logLevel","toggle","getAttribute","removeAttribute","setAttribute"],"mappings":"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"}